# SecretTalk
加密聊天工具

借用现有即时通信软件，自动化加解密消息，连服务端都不需要实现，寄生虫式的通讯方式。  
该方式很容易受到寄主的中间人攻击，只能保证受到攻击前的消息不会被解密，被攻击之后，就没办法控制了。  

## 介绍一下现在的进展  
`密钥协商` 用了 `cryptography` 实现的 `DHE`  
`加解密` 用了 `cryptography` 的 `Fernet`，已经封装好了 AES 的 CBC 模式加密，只需要提供 key 就好了，超级方便  
针对 QQ 用了 `pywin32` 来模拟交互，一直在调整前置窗口，所以会一闪一闪的，因为模拟交互有点迟钝，特别是剪贴板，所以会有一些 sleep 的操作  


## 文件的介绍  

### pure_talk.py  
一个单纯加解密的脚本，只是生成消息，需要手动复制粘贴。  
但正因为和其他通讯软件都没有关系，所以也可以说所有通讯软件都可以用（虽然这么说有点牵强）。  

两个人都执行这个脚本，交换一下公钥，然后就能互相发送加密的消息，自己解密了。  

### blink_qq.py  
一个使用模拟点击复制粘贴来和 QQ 交互的脚本，握手之后，就可以发送加密消息了。  

打开要聊天的窗口，看看自己的昵称和窗口名称（应该是小伙伴的昵称或者是你给小伙伴的备注）。  
在命令行运行脚本，按提示输入信息，等聊天窗口里有了两个以 `pk:` 开头的消息，可能过个五六秒，会话就建立了。  
然后直接回车的话，可以刷新小伙伴发来的消息，输入内容再回车的话，就是给小伙伴发消息了。  


### generate_new_parameters.py  
生成新的 parameters_bytes 的脚本。  

### parameters_bytes  
用来生成公私钥，进行密钥协商的，两个人的 parameters_bytes 必须相同。  


## 问题
通讯软件的界面都是自己实现的，不好搞到消息文本，所以应该不会有后续了，除非能够找到可以比较轻松的或者说比较正经的获取消息文本的方法。  


## TODO
- [ ] 用公私钥杜绝中间人攻击，前提是已经交换好了公钥，我没法提供可信通道
- [ ] 用公钥的 hash 做好友列表
- [ ] 重构一下，把核心的加解密提取成父类，整合功能，做成一个入口
- [ ] p2p？


## qTox
有更好的已经实现了的软件，这个项目放弃了  
https://github.com/qTox/qTox  